C==================================== 
      FUNCTION FU(X)
C==================================== 
      IMPLICIT REAL*8 (A-H,O-Z) 
      IF(X.GE.10.) GO TO 1
      IF(X.LE.0.02) GO TO 2 
C APPROXIMATION FROM M-S-(1978) 
      IF(X.LT.1.5) EPS=-0.5 
      IF(X.GE.1.5) EPS=0.5
      R=(1.+X)/X
      Q2=1./((1.+X)*(1.+X)) 
      FU=DLOG(R)-(0.36+0.03*((X+0.01)**EPS))*Q2 
      RETURN
  1   FU=(1.-1./X+2./(X*X)-6./(X*X*X))/X
      RETURN
  2   FU = DEXP(X)*(-DLOG(X)-0.5772 + X)
      RETURN
      END 
C==================================== 
      FUNCTION FA(X)
C==================================== 
      IMPLICIT REAL*8 (A-H,O-Z) 
      IF(X.LT.10) THEN    
      FA=1.-X*FU(X) 
      RETURN    
      ELSE      
      FA=(1.-2./X+6./(X*X)-24./(X*X*X)+120./(X*X*X*X))/X
      RETURN    
      ENDIF
      END 
C==================================== 
      FUNCTION FC(X)
C==================================== 
      IMPLICIT REAL*8 (A-H,O-Z) 
      IF(X.LT.10) THEN    
        FC=1.-X*FA(X) 
        RETURN    
      ELSE      
        FC=2./X-6./(X*X)+24./(X*X*X)-120./(X*X*X*X)
        RETURN    
      ENDIF
      END 
C==================================== 
      FUNCTION FD(X)
C==================================== 
      IMPLICIT REAL*8 (A-H,O-Z) 
      IF(X.LE.10) THEN    
        FD = 1. -0.5* X * (1. - X + X*X*FU(X))
        RETURN    
      ELSE    
        FD =3./X-12./(X*X) +60./(X*X*X)-360./(X*X*X*X) 
        RETURN    
      ENDIF
      END
C==================================== 
      FUNCTION FB(X)
C==================================== 
      IMPLICIT REAL*8 (A-H,O-Z) 
      IF(X.LT.1.) THEN    
      FB=1.+X-X*FU(X)*(2.+X)
      RETURN              
      ELSE
      FB=2.*X*X*X*X + 60.*X*X*X + 540.*X*X + 1512.*X + 720. 
      FB=FB/(X*X*X*X*X+35.*X*X*X*X+416.*X*X*X+2016.*X*X+3708.*X+1764.)
      FB=FB*FU(X) 
      RETURN    
      ENDIF
      END 
C==================================== 
      FUNCTION F2(X)
C==================================== 
      IMPLICIT REAL*8 (A-H,O-Z) 
      DIMENSION AP(14),AQ(14) 
      DATA AP/      2.165775917955525D+2, 2.033587105342909D+4
     ]             ,1.091065065646484D+6, 3.711399580079484D+7
     ]             ,8.396327345237503D+8, 1.288918149583380D+10 
     ]             ,1.344856883951851D+11,9.400171941902539D+11 
     ]             ,4.257075535864156D+12,1.174304576501000D+13 
     ]             ,1.754867504059569D+13,1.080630148187369D+13 
     ]             ,4.977620100319121D+11,0.D+1/
      DATA AQ/      2.195775917955525D+2, 2.098360382881574D+4
     ]             ,1.151650523623183D+6, 4.034883260913706D+7
     ]             ,9.490018565225945D+8, 1.534455719230511D+10 
     ]             ,1.718164841585205D+11,1.324851363645336D+12 
     ]             ,6.907059906460437D+12,2.353091122612837D+13 
     ]             ,4.943221846942425D+13,5.776015744186425D+13 
     ]             ,3.022538587683950D+13,3.364065905726312D+12/
      U=1./X
      IF(X.LT.10.)  THEN    
C
      U2=U*U
      U3=U2*U 
      U4=U3*U 
      F2=(-.0005725+0.01345*U+.8691*U2+.03404*U3)/(1.+2.197*U 
     &+.2454*U2+.002053*U3) 
      RETURN
C      
      ELSE
      AN=1.D+0
      AD=1.D+0
      DO 200 II=1,14
      AN=AN + AP(II)*(U**II ) 
 200  AD=AD + AQ(II)*(U**II ) 
      F2=AN*U*U/AD
      RETURN  
      ENDIF
      END 

