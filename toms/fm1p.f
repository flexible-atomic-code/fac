      double precision function fm1p(x)
      implicit real*8 (a-h, o-z)
      dimension a1(12), b1(12), a2(12), b2(12)
      data an, m1, k1, m2, k2/0.5d0, 7, 7, 10, 11/
      data a1(1)/5.75834152995465d6/
      data a1(2)/1.30964880355883d7/
      data a1(3)/1.07608632249013d7/
      data a1(4)/3.93536421893014d6/
      data a1(5)/6.42493233715640d5/
      data a1(6)/4.16031909245777d4/
      data a1(7)/7.77238678539648d2/
      data a1(8)/1.0d0/
      data b1(1)/6.49759261942269d6/
      data b1(2)/1.70750501625775d7/
      data b1(3)/1.69288134856160d7/
      data b1(4)/7.95192647756086d6/
      data b1(5)/1.83167424554505d6/
      data b1(6)/1.95155948326832d5/
      data b1(7)/8.17922106644547d3/
      data b1(8)/9.02129136642157d1/
      data a2(1)/4.85378381173415d-14/
      data a2(2)/1.64429113030738d-11/
      data a2(3)/3.76794942277806d-9/
      data a2(4)/4.69233883900644d-7/
      data a2(5)/3.40679845803144d-5/
      data a2(6)/1.32212995937796d-3/
      data a2(7)/2.60768398973913d-2/
      data a2(8)/2.48653216266227d-1/
      data a2(9)/1.08037861921488d0/
      data a2(10)/1.91247528779676d0/
      data a2(11)/1.0d0/
      data b2(1)/7.28067571760518d-14/
      data b2(2)/2.45745452167585d-11/
      data b2(3)/5.62152894375277d-9/
      data b2(4)/6.96888634549649d-7/
      data b2(5)/5.02360015186394d-5/
      data b2(6)/1.92040136756592d-3/
      data b2(7)/3.66887808002874d-2/
      data b2(8)/3.24095226486468d-1/
      data b2(9)/1.16434871200131d0/
      data b2(10)/1.34981244060549d0/
      data b2(11)/2.01311836975930d-1/
      data b2(12)/-2.14562434782759d-2/

      if (x .lt. 2d0) then
         xx=dexp(x)
         rn=xx+a1(m1)
         do i=m1-1,1,-1
            rn=rn*xx+a1(i)
         enddo
         den=b1(k1+1)
         do i=k1,1,-1
            den = den*xx+b1(i)
         enddo
         fm1p = xx*rn/den
      else
         xx=1d0/x**2
         rn=xx+a2(m2)
         do i=m2-1,1,-1
            rn=rn*xx+a2(i)
         enddo
         den=b2(k2+1)
         do i=k2,1,-1
            den=den*xx+b2(i)
         enddo
         fm1p = (x**(an+1d0))*rn/den
      endif
      return
      end
      
